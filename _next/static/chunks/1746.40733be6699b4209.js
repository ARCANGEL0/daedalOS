"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1583,1746],{71746:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var i=n(74848),a=n(33540);let r=a.Ay.div.withConfig({componentId:"sc-21247cad-0"})(["display:flex;place-content:center;canvas{background-color:#000;height:100%;width:100%;}"]);var o=n(96540),s=n(16602),l=n(62104),c=n(1364),f=n(48060),u=n(37e3);let d=({containerRef:e,id:t,setLoading:n,loading:i})=>{let{processes:{[t]:r}={}}=(0,l.N)(),{componentWindow:d,defaultSize:w={height:0,width:0},libs:h=[],maximized:m=!1}=r||{},{windowStates:{[t]:p}}=(0,c.w)(),{sizes:{titleBar:g}}=(0,a.DP)(),y=(0,o.useRef)(!1),b=(0,s.A)(),{size:v}=p||{};(0,o.useEffect)(()=>{i&&(0,u.aY)(h).then(()=>{window.ioq3&&(window.ioq3.viewport=e.current,window.ioq3.elementPointerLock=!0,window.ioq3.callMain([]),n(!1),b(window.FS,"Quake3"))})},[e,h,i,b,n]),(0,o.useEffect)(()=>{window.ioq3&&setTimeout(()=>{y.current=m;let{height:e,width:t}=!m&&v||d?.getBoundingClientRect()||{};if(!e||!t)return;let n=w?(0,u.kl)(w.width)/(0,u.kl)(w.height):4/3,i=(0,u.kl)(t),a=i>(0,u.kl)(e)-g.height,r=m&&a?i/n:i,o=r/n;o>0&&r>0&&window.ioq3?.canvas&&(window.ioq3.setCanvasSize(r,o),window.ioq3.canvas.setAttribute("style",`object-fit: ${a?"contain":"scale-down"}`))},m||y.current?f.UW.WINDOW+10:0)},[d,w,m,v,g.height]),(0,o.useEffect)(()=>()=>{try{window.ioq3?.exit()}catch{}window.AL?.contexts.forEach(({ctx:e})=>e.close())},[])};var w=n(14153);let h=({id:e})=>(0,i.jsx)(w.A,{StyledComponent:r,id:e,useHook:d})},14153:(e,t,n)=>{n.d(t,{A:()=>l});var i=n(74848),a=n(96540),r=n(51583),o=n(8218),s=n(62104);let l=(0,a.memo)(({id:e,useHook:t,StyledComponent:n,children:l})=>{let{processes:{[e]:{url:c=""}={}}}=(0,s.N)(),f=(0,a.useRef)(null),[u,d]=(0,a.useState)(!0),w=(0,a.useMemo)(()=>({contain:"strict",visibility:u?"hidden":"visible"}),[u]);return t({containerRef:f,id:e,loading:u,setLoading:d,url:c}),(0,i.jsxs)(i.Fragment,{children:[u&&(0,i.jsx)(r.default,{}),(0,i.jsx)(n,{ref:f,style:w,...(0,o.A)({id:e}),children:l})]})})},51583:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});let i=n(33540).Ay.div.withConfig({componentId:"sc-29e5eb62-0"})(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;justify-content:center;mix-blend-mode:difference;padding-top:18px;}'])},16602:(e,t,n)=>{n.d(t,{A:()=>r});var i=n(96540),a=n(41017);let r=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:n}=(0,a.f)(),r=(0,i.useRef)();return(0,i.useEffect)(()=>()=>{if(r.current){let e=r.current;r.current="",t(e,!0).then(()=>n("/",void 0,e)).catch(()=>{})}},[t,n]),(0,i.useCallback)(async(t,i)=>{if(!t)return;let a="";try{a=await e(t,i)}catch{}a&&(n("/",a),r.current=a)},[e,n])}},8218:(e,t,n)=>{n.d(t,{A:()=>h});var i=n(16286),a=n(96540),r=n(51780),o=n(16091),s=n(13296),l=n(41017),c=n(62104),f=n(1364),u=n(48060),d=n(37e3),w=n(96119);let h=({callback:e,directory:t=u.Bn,id:n,onDragLeave:h,onDragOver:m,updatePositions:p})=>{let{url:g}=(0,c.N)(),y=(0,w.w)(),{iconPositions:b,sortOrders:v,setIconPositions:A}=(0,f.w)(),{exists:k,mkdirRecursive:x,updateFolder:C,writeFile:E}=(0,l.f)(),j=(0,a.useCallback)(async(e,t,a)=>{if(n){if(t){let r=(0,i.join)(u.Bn,e);if(await x(u.Bn),await E(r,t,!0))return a===s.z.UPDATE_URL&&g(n,r),C(u.Bn,e),(0,i.basename)(r)}else a===s.z.UPDATE_URL&&g(n,e)}return""},[n,x,C,g,E]),{openTransferDialog:q}=(0,r.A)();return{onDragLeave:h,onDragOver:e=>{m?.(e),(0,d.CH)(e)},onDrop:a=>{if(u.jj.has((0,d.uQ)(t)))return;if(p&&a.target instanceof HTMLElement){let{files:e,text:n}=(0,o.bn)(a);if(0===e.length&&""===n)return;(async()=>{let r={x:a.clientX,y:a.clientY},o=[];if(n){try{o=JSON.parse(n)}catch{}if(!Array.isArray(o))return;let[e]=o;if(!e||e.startsWith(t)&&(0,i.basename)(e)===(0,i.relative)(t,e))return;o=o.map(e=>(0,i.basename)(e))}else e instanceof FileList?o=[...e].map(e=>e.name):o=[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);o=await Promise.all(o.map(async e=>{let n=`${t}/${e}`;if(!b[n]||!await k(n))return e;let a=0;do a+=1,n=`${t}/${(0,i.basename)(e,(0,i.extname)(e))} (${a})${(0,i.extname)(e)}`;while(b[n]&&await k(n));return(0,i.basename)(n)})),(0,d.$Y)(t,a.target,b,v,r,o,A,k)})()}let r="string"==typeof n;r&&!p&&t===u.Bn&&y.current[n]?.componentWindow?.focus(u.VD),(0,o.nX)(a,e||j,t,q,r)}}}}}]);