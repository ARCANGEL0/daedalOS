"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1583,8663],{48663:(e,t,i)=>{i.r(t),i.d(t,{default:()=>C});var a=i(74848);let r=i(33540).Ay.div.withConfig({componentId:"sc-e5043948-0"})(['canvas{background-color:#000;}div{font-family:"Liberation Mono","DejaVu Sans Mono","Courier New",monospace;font-size:14px;font-weight:700;line-height:normal;position:relative;white-space:pre;}']);var n=i(16286),s=i(96540);let o={autostart:!0,bios:{url:"/Program Files/Virtual x86/bios/seabios.bin"},log_level:0,network_relay_url:"wss://relay.widgetry.org/",vga_bios:{url:"/Program Files/Virtual x86/bios/vgabios.bin"},wasm_path:"/Program Files/Virtual x86/v86.wasm"},l=".bin.save",c=new Set([160,180,200,320,360,400,720,1200,1440,1722,2880]),u=e=>c.has(e>>10)&&(1023&e)==0||512===e,h=(e,t)=>".bin"===e?"bzimage":u(t)?"fda":"hda";var d=i(85531),p=i(37e3);let f="screen-set-size-graphical",m="screen-set-size-text",g=(e,t,i)=>{let{updateWindowSize:a}=(0,d.A)(e);(0,s.useEffect)(()=>{let e=([e,i])=>{let r=t.current?.querySelector("canvas");r?.style.height&&r?.style.width?a((0,p.kl)(r?.style.height),(0,p.kl)(r?.style.width)):a(i,e)},r=([,e])=>{let{height:i,width:r}=t.current?.querySelector("span:last-of-type")?.getBoundingClientRect()||{};i&&r&&a(e*i,r)};return i?.add_listener(f,e),i?.add_listener(m,r),()=>{i?.remove_listener(f,e),i?.remove_listener(m,r)}},[i,t,a])};var b=i(55650),w=i(41017),x=i(85845),y=i(62104),v=i(1364),_=i(48060),k=i(48287).Buffer;window.DEBUG=!1;let $=({containerRef:e,id:t,loading:i,setLoading:a,url:r})=>{let{processes:{[t]:c}}=(0,y.N)(),{foregroundId:u}=(0,v.w)(),{closing:d,libs:f=[]}=c||{},{appendFileToTitle:m}=(0,b.A)(t),$=(0,s.useRef)(!1),[S,C]=(0,s.useState)({}),{exists:z,mkdirRecursive:j,readFile:B,updateFolder:A,writeFile:E}=(0,w.f)(),M=(0,s.useCallback)(e=>new Promise((t,i)=>{S[e]?.save_state().then(t).catch(i)}),[S]),T=(0,s.useCallback)(async(e,t)=>{let i=`${(0,n.basename)(e)}${l}`;await z(_.Sb)||(await j(_.Sb),A((0,n.dirname)(_.Sb)));let a=(0,n.join)(_.Sb,i);if(await E(a,k.from(await M(e)),!0)){if(t){let e=(0,n.join)(_.jv,_.Sb),i=(0,n.join)(_.jv,`${a}${_.V9}`);await z(e)||(await j(e),A((0,n.dirname)(_.Sb))),await E(i,t,!0)}A(_.Sb,i)}try{S[e]?.destroy()}catch{}},[S,z,j,M,A,E]),L=(0,s.useCallback)(async()=>{let[t]=Object.keys(S);"string"==typeof t&&(await T(t),C({[r]:void 0}));let i=r?await B(r):k.from(""),a=(0,p.uQ)(r),s=".iso"===a,c=(0,p.Zd)(i),u={[s?"cdrom":h(a,i.length)]:{async:!1,size:i.length,url:c,use_parts:!1}},{deviceMemory:d=.25}=navigator,f={boot_order:s?531:561,memory_size:0x8000000*d,screen_container:e.current,vga_memory_size:8388608*d,...u,...o},g=(0,n.join)(_.Sb,`${(0,n.basename)(r)}${l}`),b=await z(g)?(0,p.Zd)(await B(g)):void 0;b&&(f.initial_state={url:b}),f.filesystem={basefs:URL.createObjectURL(new Blob([JSON.stringify((0,x.hf)())],{type:"application/json"})),baseurl:window.location?.origin??"/"};let w=new window.V86Starter(f);w.add_listener("emulator-loaded",()=>{if($.current){w.destroy();return}m((0,n.basename)(r)),(0,p.E)(c),f.initial_state&&(0,p.E)(f.initial_state.url),f.filesystem&&(0,p.E)(f.filesystem.basefs),e.current?.addEventListener("click",w.lock_mouse),C({[r]:w})})},[m,T,e,S,z,B,r]);g(t,e,S[r]),(0,s.useEffect)(()=>{i&&(0,p.aY)(f).then(()=>{window.V86Starter&&a(!1)})},[f,i,a]),(0,s.useEffect)(()=>{let e=u===t;Object.values(S).forEach(t=>t?.keyboard_set_status(e))},[S,u,t]),(0,s.useEffect)(()=>{!c||d||i||r in S||L();let t=e.current;return()=>{if(d&&!$.current){if($.current=!0,r&&S[r]){let e=e=>{window.setTimeout(()=>T(r,e),_.UW.WINDOW)};(async()=>{let e;if(S[r]?.v86.cpu.devices.vga.graphical_mode)e=t?.querySelector("canvas")?.toDataURL("image/png");else if(t instanceof HTMLElement){let i=await (0,p.em)();try{e=await i?.toPng(t,{skipAutoScale:!0})}catch{}}return e?k.from(e.replace("data:image/png;base64,",""),"base64"):void 0})().then(e).catch(e)}else S[r]?.destroy()}}},[T,d,e,S,L,i,c,r])};var S=i(14153);let C=({id:e})=>(0,a.jsxs)(S.A,{StyledComponent:r,id:e,useHook:$,children:[(0,a.jsx)("div",{onContextMenuCapture:p.CH}),(0,a.jsx)("canvas",{onContextMenuCapture:p.CH})]})},14153:(e,t,i)=>{i.d(t,{A:()=>l});var a=i(74848),r=i(96540),n=i(51583),s=i(8218),o=i(62104);let l=(0,r.memo)(({id:e,useHook:t,StyledComponent:i,children:l})=>{let{processes:{[e]:{url:c=""}={}}}=(0,o.N)(),u=(0,r.useRef)(null),[h,d]=(0,r.useState)(!0),p=(0,r.useMemo)(()=>({contain:"strict",visibility:h?"hidden":"visible"}),[h]);return t({containerRef:u,id:e,loading:h,setLoading:d,url:c}),(0,a.jsxs)(a.Fragment,{children:[h&&(0,a.jsx)(n.default,{}),(0,a.jsx)(i,{ref:u,style:p,...(0,s.A)({id:e}),children:l})]})})},51583:(e,t,i)=>{i.r(t),i.d(t,{default:()=>a});let a=i(33540).Ay.div.withConfig({componentId:"sc-29e5eb62-0"})(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;justify-content:center;mix-blend-mode:difference;padding-top:18px;}'])},8218:(e,t,i)=>{i.d(t,{A:()=>f});var a=i(16286),r=i(96540),n=i(51780),s=i(16091),o=i(13296),l=i(41017),c=i(62104),u=i(1364),h=i(48060),d=i(37e3),p=i(96119);let f=({callback:e,directory:t=h.Bn,id:i,onDragLeave:f,onDragOver:m,updatePositions:g})=>{let{url:b}=(0,c.N)(),w=(0,p.w)(),{iconPositions:x,sortOrders:y,setIconPositions:v}=(0,u.w)(),{exists:_,mkdirRecursive:k,updateFolder:$,writeFile:S}=(0,l.f)(),C=(0,r.useCallback)(async(e,t,r)=>{if(i){if(t){let n=(0,a.join)(h.Bn,e);if(await k(h.Bn),await S(n,t,!0))return r===o.z.UPDATE_URL&&b(i,n),$(h.Bn,e),(0,a.basename)(n)}else r===o.z.UPDATE_URL&&b(i,e)}return""},[i,k,$,b,S]),{openTransferDialog:z}=(0,n.A)();return{onDragLeave:f,onDragOver:e=>{m?.(e),(0,d.CH)(e)},onDrop:r=>{if(h.jj.has((0,d.uQ)(t)))return;if(g&&r.target instanceof HTMLElement){let{files:e,text:i}=(0,s.bn)(r);if(0===e.length&&""===i)return;(async()=>{let n={x:r.clientX,y:r.clientY},s=[];if(i){try{s=JSON.parse(i)}catch{}if(!Array.isArray(s))return;let[e]=s;if(!e||e.startsWith(t)&&(0,a.basename)(e)===(0,a.relative)(t,e))return;s=s.map(e=>(0,a.basename)(e))}else e instanceof FileList?s=[...e].map(e=>e.name):s=[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);s=await Promise.all(s.map(async e=>{let i=`${t}/${e}`;if(!x[i]||!await _(i))return e;let r=0;do r+=1,i=`${t}/${(0,a.basename)(e,(0,a.extname)(e))} (${r})${(0,a.extname)(e)}`;while(x[i]&&await _(i));return(0,a.basename)(i)})),(0,d.$Y)(t,r.target,x,y,n,s,v,_)})()}let n="string"==typeof i;n&&!g&&t===h.Bn&&w.current[i]?.componentWindow?.focus(h.VD),(0,s.nX)(r,e||C,t,z,n)}}}},79808:(e,t,i)=>{i.d(t,{Ay:()=>o,EX:()=>r,Ho:()=>a,WB:()=>n,lH:()=>s});let a={bottom:!1,bottomLeft:!1,bottomRight:!1,left:!1,right:!1,top:!1,topLeft:!1,topRight:!1},r={bottom:!0,bottomLeft:!0,bottomRight:!0,left:!0,right:!0,top:!0,topLeft:!0,topRight:!0},n=30,s=166,o={cancel:".cancel",dragHandleClassName:"handle",enableUserSelectHack:!1,minHeight:`${n}px`,minWidth:`${s}px`,resizeHandleStyles:{bottom:{bottom:"-3px",cursor:"ns-resize",height:"6px"},bottomLeft:{bottom:"-3px",cursor:"nesw-resize",height:"12px",left:"-3px",width:"12px"},bottomRight:{bottom:"-3px",cursor:"nwse-resize",height:"12px",right:"-3px",width:"12px"},left:{cursor:"ew-resize",left:"-3px",width:"6px"},right:{cursor:"ew-resize",right:"-3px",width:"6px"},top:{cursor:"ns-resize",height:"6px",top:"-3px"},topLeft:{cursor:"nwse-resize",height:"12px",left:"-3px",top:"-3px",width:"12px"},topRight:{cursor:"nesw-resize",height:"12px",right:"-3px",top:"-3px",width:"12px"}}}},36864:(e,t,i)=>{i.d(t,{Gn:()=>s,Ve:()=>c,WZ:()=>u,Xc:()=>l,r_:()=>o});var a=i(79808),r=i(48060),n=i(37e3);let s=(e,t,i=[],a=0)=>{let[s]=e.split(r.QB),o=`${s}${r.QB}`,l=i.find(e=>e.startsWith(o))||"",{componentWindow:c}=t?.[l]||{},{x:u=0,y:h=0,width:d=0,height:p=0}=c?.getBoundingClientRect()||{};return!(u+a+d>(0,n.e8)()||h+a+p>(0,n.Bv)())&&(u||h)?{x:u+a,y:h+a}:void 0},o=({height:e,width:t})=>{let[i,a]=[(0,n.Bv)(),(0,n.e8)()];return{x:Math.floor(a/2-(0,n.kl)(t)/2),y:Math.floor((i-r.D5)/2-(0,n.kl)(e)/2)}},l={BOTTOM:15,LEFT:150,RIGHT:50,TOP:15},c=(e,t,i=!1)=>{let{position:a,size:r}=e||{},{x:s=0,y:o=0}=a||{},{height:c=0,width:u=0}=r||{};return i?s+l.RIGHT>t.x||s+(0,n.kl)(u)-l.LEFT<0||o+l.BOTTOM>t.y||o+l.TOP<0:s<0||o<0||s+(0,n.kl)(u)>t.x||o+(0,n.kl)(c)>t.y},u=(e,t)=>{let i=Number(e.height),s=Number(e.width),[o,l]=[(0,n.Bv)(),(0,n.e8)()],c=o-r.D5,u=Math.max(a.WB,Math.min(i,c)),h=Math.max(a.lH,Math.min(s,l));if(!t)return{height:u,width:h};let d=i===u,p=s===h;return d||p?d?p?{height:u,width:h}:{height:Math.round(u/(s/h)),width:h}:{height:u,width:Math.round(h/(i/u))}:i>s?{height:u,width:Math.round(h/(c/u))}:{height:Math.round(u/(l/h)),width:h}}},55650:(e,t,i)=>{i.d(t,{A:()=>o});var a=i(96540),r=i(62104),n=i(25573),s=i(48060);let o=e=>{let{title:t}=(0,r.N)(),[i]=e.split(s.QB),{title:o}=n.A[i]||{};return{appendFileToTitle:(0,a.useCallback)((i,a)=>{let r=i?` - ${i}${a?` ${s.g6}`:""}`:"";t(e,`${o}${r}`)},[e,o,t]),prependFileToTitle:(0,a.useCallback)((i,a,r)=>{let n=i?`${a?`${s.g6} `:""}${i}${r?" ":" - "}`:"";t(e,`${n}${o}`)},[e,o,t])}}},85531:(e,t,i)=>{i.d(t,{A:()=>l});var a=i(33540),r=i(96540),n=i(36864),s=i(62104),o=i(1364);let l=e=>{let{setWindowStates:t}=(0,o.w)(),{processes:{[e]:{lockAspectRatio:i=!1,maximized:l=!1}={}}={}}=(0,s.N)(),{sizes:{titleBar:c}}=(0,a.DP)();return{updateWindowSize:(0,r.useCallback)((a,r)=>t(t=>({...t,[e]:{...t?.[e],maximized:l,size:(0,n.WZ)({height:a+c.height,width:r},i)}})),[e,i,l,t,c.height])}}}}]);